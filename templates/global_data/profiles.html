{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlowFunds - Profile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');body{font-family:'Inter',sans-serif}</style>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen max-w-md mx-auto bg-white">
        <header class="sticky top-0 z-50 w-full border-b bg-white">
            <div class="container flex h-16 items-center justify-between px-4">
                <a class="flex items-center gap-2" href="/"><div class="h-10 w-10 bg-emerald-600 rounded-lg flex items-center justify-center"><span class="text-white font-bold text-xl">FF</span></div><span class="text-xl font-bold text-gray-900">FlowFunds</span></a>
                <a href="/profile"><div class="flex items-center gap-3 cursor-pointer hover:opacity-80 transition-opacity"><div class="flex flex-col items-end"><span class="text-sm font-semibold text-gray-900">Frederic Kouassi</span><span class="text-xs text-gray-500">View Profile</span></div><div class="h-10 w-10 rounded-full overflow-hidden border-2 border-emerald-600 bg-gray-100"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-full w-full p-2 text-gray-400"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></div></div></a>
            </div>
        </header>
        <main class="pb-16"><div class="min-h-screen bg-gray-50 pb-24"><div class="container px-4 py-6 max-w-2xl mx-auto"><div class="mb-8"><a class="inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-4 w-4"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>Back to Dashboard</a><h1 class="text-3xl font-bold text-gray-900">Profile & Settings</h1><p class="text-gray-600 mt-2">Manage your account information</p></div>
        <div class="space-y-6"><div class="bg-white flex flex-col gap-6 rounded-xl border shadow-sm p-6"><div class="flex items-center justify-between mb-6"><h2 class="text-xl font-bold text-gray-900">Personal Information</h2><button type="button" id="editBtn" class="inline-flex items-center justify-center text-sm font-medium h-8 rounded-md px-3 gap-2 border bg-white shadow-sm hover:bg-gray-50"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-4 w-4"><path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"/></svg>Edit</button></div><div class="space-y-6"><div class="flex flex-col items-center gap-4 pb-6 border-b"><div class="h-24 w-24 rounded-full border-4 border-emerald-600 bg-gray-100 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-16 w-16 text-gray-400"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></div></div><div class="space-y-2"><label class="text-sm font-medium flex items-center gap-2 text-gray-700"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-4 w-4"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>Full Name</label><input class="w-full rounded-md border bg-gray-50 px-3 py-1 h-12 outline-none" id="nameDisplay" disabled value="Eddy Fotso"></div><div class="space-y-2"><label class="text-sm font-medium flex items-center gap-2 text-gray-700"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-4 w-4"><path d="m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7"/><rect x="2" y="4" width="20" height="16" rx="2"/></svg>Email</label><input type="email" class="w-full rounded-md border bg-gray-50 px-3 py-1 h-12 outline-none" id="emailDisplay" disabled value="eddy@example.com"></div><div class="space-y-2"><label class="text-sm font-medium flex items-center gap-2 text-gray-700"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-4 w-4"><path d="M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384"/></svg>Phone</label><input type="tel" class="w-full rounded-md border bg-gray-50 px-3 py-1 h-12 outline-none" id="phoneDisplay" disabled value="+237 6 XX XX XX XX"></div></div></div>
        <div class="bg-white flex flex-col gap-6 rounded-xl border shadow-sm p-6"><div class="flex items-center justify-between mb-6"><div><h2 class="text-xl font-bold text-gray-900">Linked Accounts</h2><p class="text-sm text-gray-600 mt-1">Manage your MoMo and Orange Money accounts</p></div><button type="button" id="addBtn" class="inline-flex items-center justify-center rounded-md text-sm font-medium h-9 px-4 py-2 gap-2 bg-emerald-600 hover:bg-emerald-700 text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-4 w-4"><path d="M5 12h14"/><path d="M12 5v14"/></svg>Add Account</button></div><div class="space-y-3" id="list"><div class="flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50"><div class="flex items-center gap-3"><div class="h-10 w-10 bg-yellow-500 rounded-lg flex items-center justify-center"><span class="text-white font-bold text-xs">MTN</span></div><div><div class="flex items-center gap-2"><p class="font-medium text-gray-900">MTN Mobile Money</p><span class="text-xs bg-emerald-100 text-emerald-700 px-2 py-1 rounded-full">Primary</span></div><p class="text-sm text-gray-600">+237 6 XX XX XX XX</p><p class="text-xs text-gray-500">Personal</p></div></div><button type="button" class="h-9 w-9 text-rose-600 hover:bg-rose-50 rounded-md flex items-center justify-center opacity-50 cursor-not-allowed" disabled><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-4 w-4"><path d="M10 11v6"/><path d="M14 11v6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M3 6h18"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button></div></div></div>
        <div class="bg-white flex flex-col gap-6 rounded-xl border shadow-sm p-6"><div class="mb-6"><h2 class="text-xl font-bold text-gray-900 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-5 w-5"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>Security</h2><p class="text-sm text-gray-600 mt-1">Manage your password</p></div><form method="POST" action="/change-password" class="space-y-4" id="passForm"><div class="space-y-2"><label class="text-sm font-medium">Current Password</label><input type="password" name="current_password" class="w-full rounded-md border px-3 py-1 h-12 focus:border-emerald-600 focus:ring-2 focus:ring-emerald-600/20 outline-none" placeholder="Enter current password" required></div><div class="space-y-2"><label class="text-sm font-medium">New Password</label><input type="password" name="new_password" class="w-full rounded-md border px-3 py-1 h-12 focus:border-emerald-600 focus:ring-2 focus:ring-emerald-600/20 outline-none" id="newPass" placeholder="Enter new password" required></div><div class="space-y-2"><label class="text-sm font-medium">Confirm Password</label><input type="password" name="confirm_password" class="w-full rounded-md border px-3 py-1 h-12 focus:border-emerald-600 focus:ring-2 focus:ring-emerald-600/20 outline-none" id="confPass" placeholder="Confirm password" required></div><button type="submit" class="w-full h-12 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md font-medium">Change Password</button></form></div></div></div></div></main>
        <nav class="fixed bottom-0 left-0 right-0 z-50 border-t bg-white py-2"><div class="grid grid-cols-4"><a class="flex flex-col items-center gap-1 p-2" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-5 w-5 text-gray-400"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"/><path d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg><span class="text-xs text-gray-500">Dashboard</span></a><a class="flex flex-col items-center gap-1 p-2" href="/add"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-5 w-5 text-gray-400"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/></svg><span class="text-xs text-gray-500">Add</span></a><a class="flex flex-col items-center gap-1 p-2" href="/transaction"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-5 w-5 text-gray-400"><path d="M3 5h.01"/><path d="M3 12h.01"/><path d="M3 19h.01"/><path d="M8 5h13"/><path d="M8 12h13"/><path d="M8 19h13"/></svg><span class="text-xs text-gray-500">Transactions</span></a><a class="flex flex-col items-center gap-1 p-2" href="/account"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-5 w-5 text-gray-400"><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg><span class="text-xs text-gray-500">Accounts</span></a></div></nav>
    </div>
    
    <!-- Edit Info Modal -->
    <div id="editModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"><div class="bg-white rounded-xl max-w-md w-full p-6"><div class="flex items-center justify-between mb-4"><h3 class="text-xl font-bold">Edit Personal Information</h3><button type="button" id="closeEdit" class="text-gray-400 hover:text-gray-600"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-5 w-5"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button></div><form method="POST" action="/update-profile" id="editForm" class="space-y-4"><div class="space-y-2"><label class="text-sm font-medium">Full Name</label><input type="text" name="full_name" id="editName" class="w-full rounded-md border px-3 py-1 h-12 focus:border-emerald-600 focus:ring-2 focus:ring-emerald-600/20 outline-none" value="Eddy Fotso" required></div><div class="space-y-2"><label class="text-sm font-medium">Email Address</label><input type="email" name="email" id="editEmail" class="w-full rounded-md border px-3 py-1 h-12 focus:border-emerald-600 focus:ring-2 focus:ring-emerald-600/20 outline-none" value="eddy@example.com" required></div><div class="space-y-2"><label class="text-sm font-medium">Phone Number</label><input type="tel" name="phone_number" id="editPhone" class="w-full rounded-md border px-3 py-1 h-12 focus:border-emerald-600 focus:ring-2 focus:ring-emerald-600/20 outline-none" value="+237 6 XX XX XX XX" required></div><div class="flex gap-3"><button type="button" id="cancelEdit" class="flex-1 h-12 border rounded-md hover:bg-gray-50 font-medium">Cancel</button><button type="submit" class="flex-1 h-12 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md font-medium">Save Changes</button></div></form></div></div>

    <!-- Add Account Modal -->
    <div id="modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"><div class="bg-white rounded-xl max-w-md w-full p-6"><div class="flex items-center justify-between mb-4"><h3 class="text-xl font-bold">Add Account</h3><button type="button" id="close" class="text-gray-400 hover:text-gray-600"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-5 w-5"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button></div><form method="POST" action="/add-account" id="form" class="space-y-4"><div class="space-y-2"><label class="text-sm font-medium">Account Type</label><select name="account_type" id="type" class="w-full rounded-md border px-3 py-1 h-12 focus:border-emerald-600 focus:ring-2 focus:ring-emerald-600/20 outline-none" required><option value="">Select type</option><option value="MTN">MTN Mobile Money</option><option value="Orange">Orange Money</option></select></div><div class="space-y-2"><label class="text-sm font-medium">Phone Number</label><input type="tel" name="account_phone" id="ph" class="w-full rounded-md border px-3 py-1 h-12 focus:border-emerald-600 focus:ring-2 focus:ring-emerald-600/20 outline-none" placeholder="+237 6XX XXX XXX" required></div><div class="space-y-2"><label class="text-sm font-medium">Account Label</label><input type="text" name="account_label" id="lbl" class="w-full rounded-md border px-3 py-1 h-12 focus:border-emerald-600 focus:ring-2 focus:ring-emerald-600/20 outline-none" placeholder="Personal, Business" required></div><button type="submit" class="w-full h-12 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md font-medium">Add Account</button></form></div></div>
    
    <script>
// Edit Info Modal
const editBtn=document.getElementById('editBtn'),editModal=document.getElementById('editModal'),closeEdit=document.getElementById('closeEdit'),cancelEdit=document.getElementById('cancelEdit'),editForm=document.getElementById('editForm'),editName=document.getElementById('editName'),editEmail=document.getElementById('editEmail'),editPhone=document.getElementById('editPhone'),nameDisplay=document.getElementById('nameDisplay'),emailDisplay=document.getElementById('emailDisplay'),phoneDisplay=document.getElementById('phoneDisplay');

editBtn.onclick=()=>{editName.value=nameDisplay.value;editEmail.value=emailDisplay.value;editPhone.value=phoneDisplay.value;editModal.classList.remove('hidden')};
closeEdit.onclick=()=>editModal.classList.add('hidden');
cancelEdit.onclick=()=>editModal.classList.add('hidden');
editModal.onclick=e=>{e.target===editModal&&editModal.classList.add('hidden')};
editForm.onsubmit=e=>{
    e.preventDefault();
    // Pour test visuel seulement - retirer cette partie en production
    nameDisplay.value=editName.value;
    emailDisplay.value=editEmail.value;
    phoneDisplay.value=editPhone.value;
    editModal.classList.add('hidden');
    alert('Information saved! (In production, form will submit to server)');
    // En production, commentez les lignes ci-dessus et décommentez celle-ci:
    // editForm.submit();
};

// Add Account Modal
const modal=document.getElementById('modal'),addBtn=document.getElementById('addBtn'),close=document.getElementById('close'),form=document.getElementById('form'),type=document.getElementById('type'),ph=document.getElementById('ph'),lbl=document.getElementById('lbl'),list=document.getElementById('list');
addBtn.onclick=()=>modal.classList.remove('hidden');
close.onclick=()=>modal.classList.add('hidden');
modal.onclick=e=>{e.target===modal&&modal.classList.add('hidden')};
form.onsubmit=e=>{
    e.preventDefault();
    if(!type.value||!ph.value||!lbl.value)return alert('Fill all fields');
    // Pour test visuel seulement - retirer cette partie en production
    const bg=type.value==='MTN'?'bg-yellow-500':'bg-orange-500',txt=type.value==='MTN'?'MTN':'OM',full=type.value==='MTN'?'MTN Mobile Money':'Orange Money',div=document.createElement('div');
    div.className='flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50';
    div.innerHTML=`<div class="flex items-center gap-3"><div class="h-10 w-10 ${bg} rounded-lg flex items-center justify-center"><span class="text-white font-bold text-xs">${txt}</span></div><div><p class="font-medium text-gray-900">${full}</p><p class="text-sm text-gray-600">${ph.value}</p><p class="text-xs text-gray-500">${lbl.value}</p></div></div><button type="button" class="del h-9 w-9 text-rose-600 hover:bg-rose-50 rounded-md flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="h-4 w-4"><path d="M10 11v6"/><path d="M14 11v6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M3 6h18"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button>`;
    list.appendChild(div);
    div.querySelector('.del').onclick=()=>{confirm('Delete this account?')&&(div.remove(),alert('Deleted!'))};
    modal.classList.add('hidden');
    form.reset();
    alert('Added! (In production, form will submit to server)');
    // En production, commentez les lignes ci-dessus et décommentez celle-ci:
    // form.submit();
};

// Password Form
const passForm=document.getElementById('passForm'),newPass=document.getElementById('newPass'),confPass=document.getElementById('confPass');
passForm.onsubmit=e=>{
    if(newPass.value!==confPass.value){
        e.preventDefault();
        alert('Passwords do not match!');
        return false;
    }
    // Le formulaire se soumettra automatiquement au serveur
};
    </script>
</body>
</html>